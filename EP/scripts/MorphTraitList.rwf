<DocumentElement xmlns="http://tempuri.org/Ruleset.xsd">
  <Scripts>
    <ScriptName>MorphTraitList</ScriptName>
    <FolderID>2</FolderID>
    <Script>-- 
-- Please see the license.html file included with this distribution for 
-- attribution and copyright information.
--

local sFocus = "name";

function onInit()
	if newfocus then
		sFocus = newfocus[1];
	end
end

function onListChanged()
	update();
end

function onListRearranged(listchanged)
	update();
end

function update()
	local sEdit = getName() .. "_iedit";
	local bEdit=false;
	if window[sEdit] then
		 bEdit = (window[sEdit].getValue() == 1);
	end
	local sTraits="";
	for _,w in ipairs(getWindows()) do
		w.idelete.setVisibility(bEdit);
		if sTraits=="" then sTraits=w.name.getValue();
		else sTraits=sTraits..", "..w.name.getValue();
		end
	end
	DB.setValue(getDatabaseNode(), "..MorphTraits", "string", sTraits);
end

function addEntry(bFocus)
	local w = createWindow();
	if bFocus and w[sFocus] then
		w[sFocus].setFocus();
	end
	if self.onEntryAdded then
		self.onEntryAdded(w);
	end
	return w;
end
</Script>
    <RegisterScript>true</RegisterScript>
    <Encoding />
  </Scripts>
</DocumentElement>